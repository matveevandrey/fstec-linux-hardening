# FSTEC Linux Hardening

–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –§–°–¢–≠–ö –†–§ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Linux (–æ—Ç 25.12.2022). –ü–æ–¥–¥–µ—Ä–∂–∫–∞: **Debian 12**, Ubuntu 20.04+, RHEL 8+, Astra Linux, ALT –°–ü 10.

> ‚ö†Ô∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ GRUB –∏ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.
> –†–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî `test` (–Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç).

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# —Ç–µ—Å—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
./fstec-linux-hardening.sh
./fstec-linux-hardening.sh --test

# –ø—Ä–∏–º–µ–Ω–∏—Ç—å (—Ç—Ä–µ–±—É–µ—Ç—Å—è root)
sudo ./fstec-linux-hardening.sh --apply

# –ø–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –∫–æ–º–∞–Ω–¥
./fstec-linux-hardening.sh --verbose

# –≤—ã–±—Ä–∞—Ç—å —Å–µ–∫—Ü–∏–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
./fstec-linux-hardening.sh --sections=2.1,2.3
./fstec-linux-hardening.sh --sections=kernel

# –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –º–µ—Ä—ã –ø–æ –≤–ª–∏—è–Ω–∏—é –Ω–∞ –û–°:
#   all | safe | medium | dangerous
./fstec-linux-hardening.sh --os-impact=safe

# –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —É—Ä–æ–≤–Ω—é —Ä–∏—Å–∫–∞:
#   all | low | medium | high | critical
./fstec-linux-hardening.sh --risk-level=high

```

|          ‚Ññ | –ú–µ—Ä–∞                                    | –ö–∞–∫ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è                                                            | –†–∏—Å–∫ –Ω–µ–∑–∞–∫—Ä—ã—Ç–∏—è | –í–ª–∏—è–Ω–∏–µ –Ω–∞ –û–°                 |
| ---------: | --------------------------------------- | -------------------------------------------------------------------------- | --------------- | ----------------------------- |
|  **2.1.1** | –ó–∞–ø—Ä–µ—Ç –ø—É—Å—Ç—ã—Ö –ø–∞—Ä–æ–ª–µ–π                   | –£–¥–∞–ª–µ–Ω–∏–µ `nullok` –∏–∑ PAM; –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—É—Å—Ç—ã—Ö —É—á—ë—Ç–æ–∫                         | üü•              | ‚ö™                             |
|  **2.1.2** | –ó–∞–ø—Ä–µ—Ç root-–≤—Ö–æ–¥–∞ –ø–æ SSH                | `PermitRootLogin no`                                                       | üü•              | üü°                            |
|  **2.2.1** | su —Ç–æ–ª—å–∫–æ –¥–ª—è admin-–≥—Ä—É–ø–ø—ã              | `pam_wheel.so` (–∏–ª–∏ `group=sudo`)                                          | üü°              | ‚ö™                             |
|  **2.2.2** | sudo —Ç–æ–ª—å–∫–æ –¥–ª—è admin-–≥—Ä—É–ø–ø—ã            | `%wheel` –∏–ª–∏ `%sudo` –≤ sudoers                                             | üü°              | üü°                            |
|  **2.3.1** | –ü—Ä–∞–≤–∞ –Ω–∞ `passwd/group/shadow`          | `644/644/640`, `root:root`                                                 | üü•              | ‚ö™                             |
|  **2.3.2** | –ó–∞—â–∏—Ç–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π             | `chmod 755`, `chown root:root` –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏                        | üî¥              | ‚ö™                             |
|  **2.3.3** | Cron —Ñ–∞–π–ª—ã/–∫–∞—Ç–∞–ª–æ–≥–∏                     | `chown root`, `chmod 600/700`, `chown root:crontab` –¥–ª—è —Å–ø—É–ª–∞              | üü°              | üü°                            |
|  **2.3.4** | –ê—É–¥–∏—Ç/—Ñ–∏–∫—Å SUID/SGID                    | `find -perm /6000`, whitelist, `chmod u-s,g-s`, `chown root:root`          | üü•              | üî¥                            |
|  **2.3.5** | Dotfiles –≤ \$HOME                       | `chmod 600` –Ω–∞ `.bashrc/.profile/.rhosts/*.history`                        | üü¢              | ‚ö™                             |
|  **2.3.6** | –î–æ–º–∞—à–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∏                       | `chmod 700` –Ω–∞ `/home/*` (–∫—Ä–æ–º–µ root)                                      | üü°              | ‚ö™                             |
|  **2.3.7** | –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ (rc/systemd)               | `chmod 744 /etc/rc.local`, `chmod -R go-w /etc/rc*.d`, –ø—Ä–∞–≤–∞ –Ω–∞ unit-—Ñ–∞–π–ª—ã | üü°              | ‚ö™                             |
|  **2.3.8** | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ at                          | `chmod 700 /var/spool/at`, `at.deny: *` (–∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –ø–∞–∫–µ—Ç)                | üü°              | üü°                            |
|  **2.4.1** | `kernel.dmesg_restrict=1`               | `sysctl`                                                                   | üî¥              | üü°                            |
|  **2.4.2** | `kernel.kptr_restrict=2`                | `sysctl`                                                                   | üî¥              | ‚ö™                             |
|  **2.4.3** | `net.core.bpf_jit_harden=2`             | `sysctl`                                                                   | üü°              | üü°                            |
|  **2.4.4** | `init_on_alloc=1`                       | –ü–∞—Ä–∞–º–µ—Ç—Ä —è–¥—Ä–∞ (GRUB)                                                       | üü°              | üü°                            |
|  **2.4.5** | `slab_nomerge`                          | –ü–∞—Ä–∞–º–µ—Ç—Ä —è–¥—Ä–∞ (GRUB)                                                       | üü°              | üü°                            |
|  **2.4.6** | `randomize_kstack_offset=1`             | –ü–∞—Ä–∞–º–µ—Ç—Ä —è–¥—Ä–∞ (GRUB)                                                       | üü¢              | ‚ö™                             |
|  **2.4.7** | `mitigations=auto,nosmt`                | –ü–∞—Ä–∞–º–µ—Ç—Ä —è–¥—Ä–∞ (GRUB)                                                       | üü°              | üî¥                            |
|  **2.4.8** | IOMMU –∑–∞—â–∏—Ç–∞                            | `iommu=force`, `iommu.strict=1`, `iommu.passthrough=0`                     | üü°              | üî¥                            |
|  **2.5.1** | `vsyscall=none`                         | –ü–∞—Ä–∞–º–µ—Ç—Ä —è–¥—Ä–∞ (GRUB)                                                       | üî¥              | üî¥                            |
|  **2.5.2** | `kernel.perf_event_paranoid=3`          | `sysctl`                                                                   | üü°              | üü°                            |
|  **2.5.3** | `debugfs=off`                           | –ü–∞—Ä–∞–º–µ—Ç—Ä —è–¥—Ä–∞ (GRUB)                                                       | üü¢              | üü°                            |
|  **2.5.4** | `kernel.kexec_load_disabled=1`          | `sysctl` (write-once)                                                      | üü°              | üü°                            |
|  **2.5.5** | `user.max_user_namespaces=0`            | `sysctl`                                                                   | üü•              | üî¥                            |
|  **2.5.6** | `kernel.unprivileged_bpf_disabled=1`    | `sysctl`                                                                   | üî¥              | üü°                            |
|  **2.5.7** | `vm.unprivileged_userfaultfd=0`         | `sysctl`                                                                   | üü°              | ‚ö™                             |
|  **2.5.8** | `dev.tty.ldisc_autoload=0`              | `sysctl`                                                                   | üü¢              | ‚ö™                             |
|  **2.5.9** | `vm.mmap_min_addr ‚â• 4096` (–ª—É—á—à–µ 65536) | `sysctl`                                                                   | üü°              | üî¥                            |
| **2.5.10** | `kernel.randomize_va_space=2`           | `sysctl`                                                                   | üü•              | ‚ö™                             |
|  **2.6.1** | `kernel.yama.ptrace_scope=3`            | `sysctl`                                                                   | üî¥              | üî¥                            |
|  **2.6.2** | `fs.protected_symlinks=1`               | `sysctl`                                                                   | üü°              | ‚ö™                             |
|  **2.6.3** | `fs.protected_hardlinks=1`              | `sysctl`                                                                   | üü°              | ‚ö™                             |
|  **2.6.4** | `fs.protected_fifos=2`                  | `sysctl`                                                                   | üü°              | ‚ö™ *(–º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è)* |
|  **2.6.5** | `fs.protected_regular=2`                | `sysctl`                                                                   | üü¢              | ‚ö™                             |
|  **2.6.6** | `fs.suid_dumpable=0`                    | `sysctl`                                                                   | üü°              | ‚ö™                             |

## üìä –°–≤–æ–¥–∫–∞ –ø–æ –º–µ—Ä–∞–º

### –†–∏—Å–∫ –Ω–µ–∑–∞–∫—Ä—ã—Ç–∏—è
- üü¢ **–ù–∏–∑–∫–∏–π**: 4 –º–µ—Ä—ã  
- üü° **–°—Ä–µ–¥–Ω–∏–π**: 15 –º–µ—Ä  
- üî¥ **–í—ã—Å–æ–∫–∏–π**: 13 –º–µ—Ä  
- üü• **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π**: 8 –º–µ—Ä  

### –í–ª–∏—è–Ω–∏–µ –Ω–∞ –û–°
- ‚ö™ **–ù–∏–∑–∫–æ–µ**: 19 –º–µ—Ä  
- üü° **–°—Ä–µ–¥–Ω–µ–µ**: 14 –º–µ—Ä  
- üî¥ **–í—ã—Å–æ–∫–æ–µ**: 7 –º–µ—Ä  

---

# FSTEC Linux Hardening

–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –§–°–¢–≠–ö –†–§ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Linux (–æ—Ç 25.12.2022). –ü–æ–¥–¥–µ—Ä–∂–∫–∞: **Debian 12**, Ubuntu 20.04+, RHEL 8+, Astra Linux, ALT –°–ü 10.

> ‚ö†Ô∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ GRUB –∏ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.
> –†–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî `test` (–Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç).

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# —Ç–µ—Å—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
./fstec-linux-hardening.sh
./fstec-linux-hardening.sh --test

# –ø—Ä–∏–º–µ–Ω–∏—Ç—å (—Ç—Ä–µ–±—É–µ—Ç—Å—è root)
sudo ./fstec-linux-hardening.sh --apply

# –ø–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –∫–æ–º–∞–Ω–¥
./fstec-linux-hardening.sh --verbose

# –≤—ã–±—Ä–∞—Ç—å —Å–µ–∫—Ü–∏–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
./fstec-linux-hardening.sh --sections=2.1,2.3
./fstec-linux-hardening.sh --sections=kernel

# –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –º–µ—Ä—ã –ø–æ –≤–ª–∏—è–Ω–∏—é –Ω–∞ –û–°:
#   all | safe | medium | dangerous
./fstec-linux-hardening.sh --os-impact=safe

# –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ —É—Ä–æ–≤–Ω—é —Ä–∏—Å–∫–∞:
#   all | low | medium | high | critical
./fstec-linux-hardening.sh --risk-level=high

```


|          ‚Ññ | –ú–µ—Ä–∞                                 | –ö–∞–∫ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ —Å–∫—Ä–∏–ø—Ç–µ                             | –†–∏—Å–∫ –Ω–µ–∑–∞–∫—Ä—ã—Ç–∏—è |             –í–ª–∏—è–Ω–∏–µ –Ω–∞ –û–°             |
| ---------: | ------------------------------------ | ----------------------------------------------------- | :-------------: | :-----------------------------------: |
|  **2.1.1** | –ó–∞–ø—Ä–µ—Ç –ø—É—Å—Ç—ã—Ö –ø–∞—Ä–æ–ª–µ–π                | –£–¥–∞–ª–µ–Ω–∏–µ `nullok` –∏–∑ PAM; –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—É—Å—Ç—ã—Ö —É—á—ë—Ç–æ–∫    |        üî¥       |                   ‚ö™                   |
|  **2.1.2** | –ó–∞–ø—Ä–µ—Ç root-–≤—Ö–æ–¥–∞ –ø–æ SSH             | `PermitRootLogin no`                                  |        üî¥       |      üü° (–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏–≤—ã—á–Ω—ã–π –≤—Ö–æ–¥)     |
|  **2.2.1** | `su` —Ç–æ–ª—å–∫–æ –¥–ª—è admin-–≥—Ä—É–ø–ø—ã         | `pam_wheel.so use_uid`                                |        üü°       |                   ‚ö™                   |
|  **2.2.2** | `sudo` —Ç–æ–ª—å–∫–æ –¥–ª—è admin-–≥—Ä—É–ø–ø—ã       | `%wheel ALL=(ALL:ALL) ALL` (–∏–ª–∏ `%sudo`)              |        üü°       |   üü° (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –≥—Ä—É–ø–ø—É)  |
|  **2.3.1** | –ü—Ä–∞–≤–∞ –Ω–∞ `passwd/group/shadow`       | `644/644/640`, `root:root`                            |        üî¥       |                   ‚ö™                   |
|  **2.3.2** | –ó–∞—â–∏—Ç–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π          | `chmod go-w` –Ω–∞ `/bin /sbin /usr/bin /usr/sbin /lib*` |        üî¥       |                   ‚ö™                   |
|  **2.3.3** | –ê—É–¥–∏—Ç/—Ñ–∏–∫—Å SUID/SGID                 | –ü–æ–∏—Å–∫ `-perm /6000`, white-list, `chmod u-s,g-s`      |        üî¥       |    üî¥ (–º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å —á–∞—Å—Ç—å —É—Ç–∏–ª–∏—Ç)    |
|  **2.3.4** | –ü—Ä–∞–≤–∞ –≤ `$HOME` (dotfiles)           | `chmod go-rwx` –Ω–∞ `.bashrc/.profile/.rhosts`          |        üü°       |                   ‚ö™                   |
|  **2.3.5** | –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ (rc/systemd)            | –ü—Ä–∞–≤–∞ –Ω–∞ `rc.local/rc*.d` –∏ —é–Ω–∏—Ç—ã systemd             |        üü°       |                   ‚ö™                   |
|  **2.3.6** | User-cron                            | –ñ—ë—Å—Ç–∫–∏–µ –ø—Ä–∞–≤–∞ `/var/spool/cron`                       |        üü°       |                   üü°                  |
|  **2.3.7** | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ `at`                     | –ü—Ä–∞–≤–∞ `/var/spool/at`, `at.deny` (–∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –ø–∞–∫–µ—Ç)  |        üü°       |                   üü°                  |
|  **2.3.8** | –ü—Ä–∞–≤–∞ –Ω–∞ `bin/sbin/lib*`             | 755/750, `root:root`                                  |        üî¥       |                   ‚ö™                   |
|  **2.3.9** | –ö–æ–Ω—Ç—Ä–æ–ª—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–∏–Ω–∞—Ä–µ–π           | –ü—Ä–æ–≤–µ—Ä–∫–∞/–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º–æ—Å—Ç–∏                   |        üü°       |                   ‚ö™                   |
| **2.3.10** | –î–æ–º–∞—à–Ω–∏–µ —Ñ–∞–π–ª—ã (–∏—Å—Ç–æ—Ä–∏–∏)             | `chmod go-rwx` –Ω–∞ `.bash_history` –∏ –¥—Ä.               |        üü°       |                   ‚ö™                   |
| **2.3.11** | –î–æ–º–∞—à–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∏                    | `chmod 700` –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π                 |        üü°       |                   ‚ö™                   |
|  **2.4.1** | `kernel.dmesg_restrict=1`            | `sysctl`                                              |        üü°       |    üü° (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –æ—Ç–ª–∞–¥–∫—É dmesg)    |
|  **2.4.2** | `kernel.kptr_restrict=2`             | `sysctl`                                              |        üü°       |                   ‚ö™                   |
|  **2.4.3** | `init_on_alloc=1`                    | GRUB –ø–∞—Ä–∞–º–µ—Ç—Ä                                         |        üü°       |        üü° (–Ω–µ–±–æ–ª—å—à–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞)        |
|  **2.4.4** | `slab_nomerge`                       | GRUB –ø–∞—Ä–∞–º–µ—Ç—Ä                                         |        üü°       |           üü° (–ø–æ—Ç–µ–Ω—Ü. ‚Üë RAM)          |
|  **2.4.5** | IOMMU: `force/strict`                | GRUB –ø–∞—Ä–∞–º–µ—Ç—Ä                                         |        üü°       |    üî¥ (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å PCI/–¥—Ä–∞–π–≤–µ—Ä–æ–≤)   |
|  **2.4.6** | `randomize_kstack_offset=1`          | GRUB –ø–∞—Ä–∞–º–µ—Ç—Ä                                         |        üü°       |                   ‚ö™                   |
|  **2.4.7** | `mitigations=auto,nosmt`             | GRUB –ø–∞—Ä–∞–º–µ—Ç—Ä                                         |        üü°       |      üî¥ (–ø—Ä–æ—Å–∞–¥–∫–∞ –∏–∑-–∑–∞ SMT off)      |
|  **2.4.8** | `net.core.bpf_jit_harden=2`          | `sysctl`                                              |        üü°       |        üü° (—Å–ª–æ–∂–Ω–µ–µ –æ—Ç–ª–∞–¥–∫–∞ BPF)       |
|  **2.5.1** | `vsyscall=none`                      | GRUB –ø–∞—Ä–∞–º–µ—Ç—Ä                                         |        üü°       |        üî¥ (–ª–æ–º–∞–µ—Ç —Å—Ç–∞—Ä—ã–π —Å–æ—Ñ—Ç)        |
|  **2.5.2** | `kernel.perf_event_paranoid=3`       | `sysctl`                                              |        üü°       |         üü° (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç perf)        |
|  **2.5.3** | `debugfs=off`                        | GRUB –ø–∞—Ä–∞–º–µ—Ç—Ä                                         |        üü°       |            üü° (–Ω–µ—Ç debugfs)           |
|  **2.5.4** | `kernel.kexec_load_disabled=1`       | `sysctl`                                              |        üü°       |       üü° (–Ω–µ—Ç kexec/live-reboot)      |
|  **2.5.5** | `user.max_user_namespaces=0`         | `sysctl`                                              |        üü°       |    üî¥ (–ª–æ–º–∞–µ—Ç rootless-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã)    |
|  **2.5.6** | `kernel.unprivileged_bpf_disabled=1` | `sysctl`                                              |        üü°       |                   üü°                  |
|  **2.5.7** | `vm.unprivileged_userfaultfd=0`      | `sysctl`                                              |        üü°       |                   ‚ö™                   |
|  **2.5.8** | `dev.tty.ldisc_autoload=0`           | `sysctl`                                              |        üü°       |                   ‚ö™                   |
|  **2.5.9** | `tsx=off`                            | GRUB –ø–∞—Ä–∞–º–µ—Ç—Ä                                         |        üü°       |  üü° (–Ω–µ–±–æ–ª—å—à–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –Ω–∞ Intel TSX) |
| **2.5.10** | `vm.mmap_min_addr ‚â• 4096`            | `sysctl` (—Ä–µ–∫–æ–º. 65536)                               |        üü°       |    üî¥ (–º–æ–∂–µ—Ç –ª–æ–º–∞—Ç—å Wine/—ç–º—É–ª—è—Ç–æ—Ä—ã)   |
| **2.5.11** | `kernel.randomize_va_space=2`        | `sysctl`                                              |        üî¥       |                   ‚ö™                   |
|  **2.6.1** | `kernel.yama.ptrace_scope=3`         | `sysctl`                                              |        üü°       | üî¥ (–ª–æ–º–∞–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ptrace-debug) |
|  **2.6.2** | `fs.protected_symlinks=1`            | `sysctl`                                              |        üü°       |                   ‚ö™                   |
|  **2.6.3** | `fs.protected_hardlinks=1`           | `sysctl`                                              |        üü°       |                   ‚ö™                   |
|  **2.6.4** | `fs.protected_fifos=2`               | `sysctl`                                              |        üü°       |                   ‚ö™                   |
|  **2.6.5** | `fs.protected_regular=2`             | `sysctl`                                              |        üü°       |                   ‚ö™                   |
|  **2.6.6** | `fs.suid_dumpable=0`                 | `sysctl`                                              |        üü°       |                   ‚ö™                   |
